x <- rbinom(n, size = 1, pi)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
posterior <- posterior/sum(posterior)
y <- cumsum(posterior)
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, pi, alpha, beta, seed=42)))
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
library(reshape2)
library(ggplot2)
n <- 50
success_prob <- .8
alpha <- .5
beta  <- 10
theta <- 0.3
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
x <- rbinom(n, size = 1, pi)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- cumsum(posterior)
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
x <- rbinom(n, size = 1, pi)
k <- sum(x)
posterior <- sort(dbeta(theta, alpha+k, beta+n-k))
# posterior <- posterior/sum(posterior)
y <- cumsum(posterior)
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
n <- 50
success_prob <- .8
alpha <- .5
beta  <- 10
theta <- 0.3
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
x <- rbinom(n, size = 1, pi)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- sort(cumsum(posterior))
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
x <- rbinom(n, size = 1, pi)
k <- sum(x)
plot(1:n, dbeta(theta, alpha+k, beta+n-k))
plot(1:n, sapply(1:n, dbeta(theta, alpha+k, beta+n-k)))
n <- 50
success_prob <- .8
alpha <- .5
beta  <- 10
theta <- 0.3
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- sort(cumsum(posterior))
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
n <- 50
success_prob <- .8
alpha <- .5
beta  <- 10
theta <- 0.3
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- sort(cumsum(posterior))
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
set.seed(seed)
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- sort(cumsum(posterior))
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
set.seed(seed)
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- sort(cumsum(posterior))
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
set.seed(seed)
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- sort(cumsum(posterior))
return(y)
}
plot(1:100, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
n <- 1000
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
set.seed(seed)
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- sort(cumsum(posterior))
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
set.seed(seed)
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- cumsum(posterior)
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
n <- 50
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
n <- 50
success_prob <- .2
alpha <- .5
beta  <- 10
theta <- 0.3
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
set.seed(seed)
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- cumsum(posterior)
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
n <- 100
success_prob <- .2
alpha <- .5
beta  <- 10
theta <- 0.3
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
set.seed(seed)
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- cumsum(posterior)
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
n <- 500
success_prob <- .2
alpha <- .5
beta  <- 10
theta <- 0.3
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
set.seed(seed)
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- cumsum(posterior)
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
n <- 500
success_prob <- .2
alpha <- .5
beta  <- 10
theta <- 0.3
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
set.seed(seed)
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
posterior <- posterior/sum(posterior)
y <- cumsum(posterior)
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob, alpha, beta, seed=42)))
n <- 100
success_prob <- .2
alpha <- .5
beta  <- 10
theta <- 0.3
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
set.seed(seed)
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- cumsum(posterior)/sum(cumsum(posterior))
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob,
alpha, beta, seed=42)))
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
set.seed(seed)
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- posterior
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob,
alpha, beta, seed=42)))
n <- 100
success_prob <- .2
alpha <- .5
beta  <- 10
theta <- 0.3
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- posterior
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob,
alpha, beta, seed=42)))
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
# posterior <- posterior/sum(posterior)
y <- posterior
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob,
alpha, beta, seed=42)))
n <- 100
success_prob <- .2
alpha <- .5
beta  <- 10
theta <- 0.3
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
posterior <- posterior/sum(posterior)
y <- posterior
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob,
alpha, beta, seed=42)))
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
posterior <- dbeta(theta, alpha+k, beta+n-k)
plot(1:n, dbeta(theta, alpha+k, beta+n-k))
n <- 100
success_prob <- .2
alpha <- .5
beta  <- 10
theta <- 0.3
plot(1:n, dbeta(theta, alpha+k, beta+n-k))
plot(sapply(1:n, function(n) dbeta(theta, alpha+k, beta+n-k)))
plot(1:n, sapply(1:n, function(n) dbeta(theta, alpha+k, beta+n-k)))
plot(1:n, sapply(1:n, function(n) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
dbeta(theta, alpha+k, beta+n-k)}))
hist(sapply(1:n, function(n) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
dbeta(theta, alpha+k, beta+n-k)}))
plot(1:n, sapply(1:n, function(n) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
dbeta(theta, alpha+k, beta+n-k)}))
n <- 10000
success_prob <- .2
plot(1:n, sapply(1:n, function(n) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
dbeta(theta, alpha+k, beta+n-k)}))
plot(1:n, sapply(1:n, function(n) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
dbeta(theta, alpha+k, beta+n-k)}))
n <- 1000
plot(1:n, sapply(1:n, function(n) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
print(n,k)
dbeta(theta, alpha+k, beta+n-k)}))
plot(1:n, sapply(1:n, function(n) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
print(sprintf("(n,k))(%i,%i)",n,k))
dbeta(theta, alpha+k, beta+n-k)}))
plot(1:n, sapply(1:n, function(n) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
print(sprintf("(n,k)=(%i,%i)",n,k))
dbeta(theta, alpha+k, beta+n-k)}))
n <- 1000
success_prob <- .9
plot(1:n, sapply(1:n, function(n) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
print(sprintf("(n,k)=(%i,%i)",n,k))
dbeta(theta, alpha+k, beta+n-k)}))
n <- 1000
success_prob <- .1
alpha <- .5
beta  <- 10
theta <- 0.3
plot(1:n, sapply(1:n, function(n) {
x <- rbinom(n, size = 1, success_prob)
k <- sum(x)
print(sprintf("(n,k)=(%i,%i)",n,k))
dbeta(theta, alpha+k, beta+n-k)}))
plot(1:n, sapply(1:n, function(n) {
k <- floor(n*success_prob)
print(sprintf("(n,k)=(%i,%i)",n,k))
dbeta(theta, alpha+k, beta+n-k)}))
n <- 100
success_prob <- .1
alpha <- .5
beta  <- 10
theta <- 0.3
plot(1:n, sapply(1:n, function(n) {
k <- floor(n*success_prob)
print(sprintf("(n,k)=(%i,%i)",n,k))
dbeta(theta, alpha+k, beta+n-k)}))
plot(1:n, sapply(1:n, function(n) {
k <- round(n*success_prob, 0)
print(sprintf("(n,k)=(%i,%i)",n,k))
dbeta(theta, alpha+k, beta+n-k)}))
plot(sapply(1:n, function(n) {
k <- round(n*success_prob, 0)
print(sprintf("(n,k)=(%i,%i)", n, k))
dbeta(theta, alpha+k, beta+n-k)}))
plot(sapply(1:n, function(n) {
k <- round(n*success_prob, 0)
print(sprintf("(n,k)=(%i,%i)", n, k))
dbeta(theta, alpha+k, beta+n-k)}))
plot(sapply(1:n, function(n) {
k <- round(n*success_prob, 0)
print(sprintf("(n,k)=(%i,%i)", n, k))
cumsum(dbeta(theta, alpha+k, beta+n-k)})))
plot(sapply(1:n, function(n) {
k <- round(n*success_prob, 0)
print(sprintf("(n,k)=(%i,%i)", n, k))
cumsum(dbeta(theta, alpha+k, beta+n-k))}))
plot(sapply(1:n, function(n) {
k <- round(n*success_prob, 0)
print(sprintf("(n,k)=(%i,%i)", n, k))
dbeta(theta, alpha+k, beta+n-k)}))
cdf_posterior <- function(theta, n, success_prob, alpha, beta, seed=42) {
# x <- rbinom(n, size = 1, success_prob)
# k <- sum(x)
k <- round(n*success_prob, 0)
posterior <- dbeta(theta, alpha+k, beta+n-k)
y <- posterior
return(y)
}
cdf_posterior <- function(theta, n, success_prob, alpha, beta) {
# x <- rbinom(n, size = 1, success_prob)
# k <- sum(x)
k <- round(n*success_prob, 0)
posterior <- dbeta(theta, alpha+k, beta+n-k)
y <- posterior
return(y)
}
plot(cdf_posterior(theta, n, success_prob, alpha, beta))
n <- 100
plot(cdf_posterior(theta, 1:n, success_prob, alpha, beta))
cdf_posterior <- function(theta, n, success_prob, alpha, beta) {
# x <- rbinom(n, size = 1, success_prob)
# k <- sum(x)
k <- round(n*success_prob, 0)
posterior <- dbeta(theta, alpha+k, beta+n-k)
y <- posterior
return(y)
}
plot(1:n, sapply(1:n, function(n) cdf_posterior(theta, n, success_prob,
alpha, beta)))
plot(sapply(1:n, function(n) cdf_posterior(theta, n, success_prob,
alpha, beta)))
cdf_posterior <- function(theta, n, success_prob, alpha, beta) {
# x <- rbinom(n, size = 1, success_prob)
# k <- sum(x)
k <- round(n*success_prob, 0)
posterior <- dbeta(theta, alpha+k, beta+n-k)
y <- cumsum(posterior)
return(y)
}
plot(sapply(1:n, function(n) cdf_posterior(theta, n, success_prob,
alpha, beta)))
plot(sapply(1:n, function(n) cdf_posterior(theta, n,
success_prob,
alpha, beta)))
cdf_posterior <- function(theta, n, success_prob, alpha, beta) {
# x <- rbinom(n, size = 1, success_prob)
# k <- sum(x)
k <- round(n*success_prob, 0)
posterior <- dbeta(theta, alpha+k, beta+n-k)
y <- cumsum(posterior)
return(y)
}
plot(sapply(1:n, function(n) cdf_posterior(theta, n,
success_prob,
alpha, beta)))
n <- 100
success_prob <- .1
alpha <- .5
beta  <- 10
theta <- 0.3
cdf_posterior <- function(theta, n, success_prob, alpha, beta) {
# x <- rbinom(n, size = 1, success_prob)
# k <- sum(x)
k <- round(n*success_prob, 0)
posterior <- dbeta(theta, alpha+k, beta+n-k)
y <- cumsum(posterior)
return(y)
}
plot(sapply(1:n, function(n) cdf_posterior(theta, n,
success_prob,
alpha, beta)))
sapply(1:n, function(n) cdf_posterior(theta, n,
success_prob,
alpha, beta))
plot(sort(sapply(1:n, function(n) cdf_posterior(theta, n,
success_prob,
alpha, beta))))
cdf_posterior <- function(theta, n, success_prob, alpha, beta) {
# x <- rbinom(n, size = 1, success_prob)
# k <- sum(x)
k <- round(n*success_prob, 0)
posterior <- dbeta(theta, alpha+k, beta+n-k)
y <- posterior
return(y)
}
plot(sort(sapply(1:n, function(n) cdf_posterior(theta, n,
success_prob,
alpha, beta))))
cdf_posterior <- function(theta, n, success_prob, alpha, beta) {
# x <- rbinom(n, size = 1, success_prob)
# k <- sum(x)
k <- round(n*success_prob, 0)
posterior <- dbeta(theta, alpha+k, beta+n-k)
y <- posterior/sum(posterior)
return(y)
}
plot(sort(sapply(1:n, function(n) cdf_posterior(theta, n,
success_prob,
alpha, beta))))
cdf_posterior <- function(theta, n, success_prob, alpha, beta) {
# x <- rbinom(n, size = 1, success_prob)
# k <- sum(x)
k <- round(n*success_prob, 0)
posterior <- dbeta(theta, alpha+k, beta+n-k)
y <- posterior
return(y)
}
plot(sort(sapply(1:n, function(n) cdf_posterior(theta, n,
success_prob,
alpha, beta))))
plot(sort(sapply(1:n, function(n) cdf_posterior(0.1, n,
success_prob,
alpha, beta))))
plot(sort(sapply(1:n, function(n) cdf_posterior(0.5, n,
success_prob,
alpha, beta))))
plot(sort(sapply(1:n, function(n) cdf_posterior(0.4, n,
success_prob,
alpha, beta))))
plot(sort(sapply(1:n, function(n) cdf_posterior(0.2, n,
success_prob,
alpha, beta))))
cdf_posterior(0.2, n, success_prob, alpha, beta)
cdf_posterior(0.2, 1, success_prob, alpha, beta)
cdf_posterior(0.2, 2, success_prob, alpha, beta)
plot(sort(sapply(1:n, function(n) cumsum(cdf_posterior(0.2, n,
success_prob,
alpha, beta)))))
cdf_posterior(0.2, 1:10, success_prob, alpha, beta)
cumsum(cdf_posterior(0.2, 1:10, success_prob, alpha, beta))
plot(cumsum(cdf_posterior(0.2, 1:10, success_prob, alpha, beta)))
plot(cumsum(cdf_posterior(0.2, 1:10, success_prob, alpha, beta))/sum(cumsum(cdf_posterior(0.2, 1:10, success_prob, alpha, beta))))
plot(cumsum(cdf_posterior(0.2, 1:10, success_prob, alpha, beta)))
plot(cumsum(cdf_posterior(0.2, 1:100, success_prob, alpha, beta)))
cdf_posterior <- function(theta, n, success_prob, alpha, beta) {
# x <- rbinom(n, size = 1, success_prob)
# k <- sum(x)
k <- round(n*success_prob, 0)
posterior <- dbeta(theta, alpha+k, beta+n-k)
return(posterior)
}
plot(cumsum(cdf_posterior(0.2, 1:100, success_prob, alpha, beta)))
plot(sort(cumsum(cdf_posterior(0.2, 1:100, success_prob, alpha, beta))))
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
